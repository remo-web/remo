(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+v/2":function(t,e,i){"use strict";var o=i("o0Bx"),s=i("Jq2H");o.registerAbortRequestHandler(s.ServerModuleName,(function(t,e){switch(t.Method){case"GetFiles":return"GetFiles"===e.Method}return!1})),t.exports={send:function(t,e,i,n){o.send(s.ServerModuleName,t,e,i,n)},sendToWebclient:function(t,e,i,s){o.send("FilesWebclient",t,e,i,s)}}},"42lS":function(t,e,i){"use strict";var o=i("F/us"),s=i("0h2I"),n=i("czxF");function r(){n.call(this),this.htmlEmbed=s.observable("")}o.extendOwn(r.prototype,n.prototype),r.prototype.PopupTemplate="CoreWebclient_EmbedHtmlPopup",r.prototype.onOpen=function(t){this.htmlEmbed(t)},r.prototype.close=function(){this.closePopup(),this.htmlEmbed("")},t.exports=new r},"4KVt":function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("0h2I"),r=i("Yjhd"),a=i("czxF"),l=i("+v/2"),h=i("Pg7U");function u(){a.call(this),this.fCallback=null,this.link=n.observable(""),this.linkPrev=n.observable(""),this.linkFocus=n.observable(!1),this.checkTimeout=null,this.urlChecked=n.observable(!1),this.saveCommand=r.createCommand(this,this.executeSave,(function(){return this.urlChecked()})),this.fileItem=n.observable(null)}o.extendOwn(u.prototype,a.prototype),u.prototype.PopupTemplate="FilesWebclient_CreateLinkPopup",u.prototype.onOpen=function(t){this.link(""),this.linkFocus(!0),this.fCallback=t,this.checkTimer=setTimeout(o.bind(this.checkUrl,this),2e3)},u.prototype.checkUrl=function(){clearTimeout(this.checkTimer),this.link()!==this.linkPrev()&&(this.linkPrev(this.link()),l.send("CheckUrl",{Url:this.link()},this.onCheckUrlResponse,this)),this.checkTimer=setTimeout(o.bind(this.checkUrl,this),1e3)},u.prototype.onCheckUrlResponse=function(t,e){if(t.Result){var i=h.prepareLinkData(t.Result,this.link()),o=new h(i);this.fileItem(o),this.urlChecked(!0)}},u.prototype.executeSave=function(){s.isFunction(this.fCallback)&&(this.fCallback(this.fileItem()),this.link(""),this.linkPrev(""),this.urlChecked(!1)),clearTimeout(this.checkTimer),this.closePopup()},u.prototype.cancelPopup=function(){this.link(""),this.linkPrev(""),this.urlChecked(!1),clearTimeout(this.checkTimer),this.closePopup()},t.exports=new u},"5hOJ":function(t,e,i){"use strict";var o=i("wd/R"),s=i("RN+F"),n=i("Yjhd"),r=i("hPb3");function a(){this.iTimeStampInUTC=0,this.oMoment=null}a.prototype.parse=function(t){this.iTimeStampInUTC=t,this.oMoment=o.unix(this.iTimeStampInUTC)},a.prototype.setDate=function(t,e,i){this.oMoment=o([t,e,i])},a.prototype.getTimeFormat=function(){return r.timeFormat()===window.Enums.TimeFormat.F24?"HH:mm":"hh:mm A"},a.prototype.getFullDate=function(){return this.getDate()+" "+this.getTime()},a.prototype.getMidDate=function(){return this.getShortDate(!0)},a.prototype.getShortDate=function(t){var e="",i=null;return this.oMoment&&((i=o()).format("L")===this.oMoment.format("L")?e=this.oMoment.format(this.getTimeFormat()):(e=i.clone().subtract(1,"days").format("L")===this.oMoment.format("L")?s.i18n("COREWEBCLIENT/LABEL_YESTERDAY"):r.UserSelectsDateFormat?this.oMoment.format(n.getDateFormatForMoment(r.dateFormat())):i.year()===this.oMoment.year()?this.oMoment.format("MMM D"):this.oMoment.format("MMM D, YYYY"),t&&(e+=", "+this.oMoment.format(this.getTimeFormat())))),e},a.prototype.getDate=function(){var t="ddd, MMM D, YYYY";return r.UserSelectsDateFormat&&(t="ddd, "+n.getDateFormatForMoment(r.dateFormat())),this.oMoment?this.oMoment.format(t):""},a.prototype.getTime=function(){return this.oMoment?this.oMoment.format(this.getTimeFormat()):""},a.prototype.getTimeStampInUTC=function(){return this.iTimeStampInUTC},t.exports=a},AGjx:function(t,e,i){"use strict";var o=i("0h2I"),s=i("IAk5"),n=i("hPb3");function r(){this.davServer=o.observable(""),this.credentialsHintText=s.mobileCredentialsHintText,this.bDemo=n.IsDemo}r.prototype.ViewTemplate="FilesWebclient_MobileSyncSettingsView",r.prototype.populate=function(t){this.davServer(t.Server)},t.exports=new r},Au6d:function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("0h2I"),r=i("czxF");function a(){r.call(this),this.fCallback=null,this.folderName=n.observable(""),this.folderName.focus=n.observable(!1),this.folderName.error=n.observable(""),this.folderName.subscribe((function(){this.folderName.error("")}),this)}o.extendOwn(a.prototype,r.prototype),a.prototype.PopupTemplate="FilesWebclient_CreateFolderPopup",a.prototype.onOpen=function(t){this.folderName(""),this.folderName.focus(!0),this.folderName.error(""),s.isFunction(t)&&(this.fCallback=t)},a.prototype.onOKClick=function(){if(this.folderName.error(""),this.fCallback){var t=this.fCallback(this.folderName());t?this.folderName.error(""+t):this.closePopup()}else this.closePopup()},t.exports=new a},"Ig+v":function(t,e,i){var o=i("0h2I"),s=i("QaF5");function n(t){this.sName="",this.visible=o.observable(!0),this.baseHash=o.observable(""),this.hash=o.observable(""),this.linkText=o.observable(t),this.isCurrent=o.observable(!1),this.recivedAnim=o.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=o.observable(0),this.allowChangeTitle=o.observable(!1),this.inactiveTitle=o.observable(""),this.excludedHashes=o.observableArray([])}n.prototype.ViewTemplate="CoreWebclient_HeaderItemView",n.prototype.setName=function(t){this.sName=t.toLowerCase(),""===this.baseHash()?(this.hash(s.buildHashFromArray([t.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},t.exports=n},Jq2H:function(t,e,i){"use strict";i("0h2I");var o=i("F/us"),s=i("AFLV");t.exports={ServerModuleName:"Files",CorporateServerModuleName:"CorporateFiles",PersonalServerModuleName:"PersonalFiles",HashModuleName:"files",CustomTabTitle:"",Storages:[],EnableUploadSizeLimit:!1,PublicFolderName:"",PublicHash:"",UploadSizeLimitMb:0,UserSpaceLimitMb:0,TenantSpaceLimitMb:0,CorporateSpaceLimitMb:0,EditFileNameWithoutExtension:!1,ShowCommonSettings:!0,ShowFilesApps:!0,BottomLeftCornerLinks:[],ShowPersonalFilesAdminSection:!1,ShowCorporateFilesAdminSection:!1,init:function(t){var e=t[this.ServerModuleName],i=t[this.CorporateServerModuleName],n=t.FilesWebclient;o.isEmpty(e)||(this.CustomTabTitle=s.pString(e.CustomTabTitle,this.CustomTabTitle),this.Storages=s.pArray(e.Storages,this.Storages),this.EnableUploadSizeLimit=s.pBool(e.EnableUploadSizeLimit,this.EnableUploadSizeLimit),this.PublicFolderName=s.pString(e.PublicFolderName,this.PublicFolderName),this.PublicHash=s.pString(e.PublicHash,this.PublicHash),this.UploadSizeLimitMb=s.pNonNegativeInt(e.UploadSizeLimitMb,this.UploadSizeLimitMb),this.UserSpaceLimitMb=s.pNonNegativeInt(e.UserSpaceLimitMb,this.UserSpaceLimitMb),this.TenantSpaceLimitMb=s.pNonNegativeInt(e.TenantSpaceLimitMb,this.TenantSpaceLimitMb)),this.ShowPersonalFilesAdminSection=!0,o.isEmpty(i)||(this.ShowCorporateFilesAdminSection=!0,this.CorporateSpaceLimitMb=s.pNonNegativeInt(i.SpaceLimitMb,this.CorporateSpaceLimitMb)),o.isEmpty(n)||(this.EditFileNameWithoutExtension=s.pBool(n.EditFileNameWithoutExtension,this.EditFileNameWithoutExtension),this.ShowCommonSettings=s.pBool(n.ShowCommonSettings,this.ShowCommonSettings),this.ShowFilesApps=s.pBool(n.ShowFilesApps,this.ShowFilesApps),this.BottomLeftCornerLinks=s.pArray(n.BottomLeftCornerLinks,this.BottomLeftCornerLinks))},updateAdmin:function(t,e){this.EnableUploadSizeLimit=t,this.UploadSizeLimitMb=e},updateAdminPersonal:function(t){this.PersonalSpaceLimitMb=t},updateAdminCorporate:function(t){this.CorporateSpaceLimitMb=t}}},KM9R:function(t,e,i){"use strict";var o=i("F/us"),s=i("0h2I"),n=i("ZP6a"),r=i("czxF"),a=i("+v/2"),l=i("MTJk");function h(){r.call(this),this.item=null,this.pub=s.observable(""),this.pubFocus=s.observable(!1)}o.extendOwn(h.prototype,r.prototype),h.prototype.PopupTemplate="FilesWebclient_SharePopup",h.prototype.onOpen=function(t){this.item=t,this.pub(""),a.send("CreatePublicLink",{Type:t.storageType(),Path:t.path(),Name:t.fileName(),Size:t instanceof l?0:t.size(),IsFolder:t instanceof l},this.onCreatePublicLinkResponse,this)},h.prototype.onCreatePublicLinkResponse=function(t,e){t.Result&&(this.pub(n.getAppPath()+t.Result),this.pubFocus(!0),this.item.published(!0))},h.prototype.onCancelSharingClick=function(){this.item&&(a.send("DeletePublicLink",{Type:this.item.storageType(),Path:this.item.path(),Name:this.item.fileName()},this.closePopup,this),this.item.published(!1))},t.exports=new h},MTJk:function(t,e,i){"use strict";var o=i("0h2I"),s=i("AFLV"),n=i("IAk5"),r=i("cGGv");function a(){this.selected=o.observable(!1),this.checked=o.observable(!1),this.deleted=o.observable(!1),this.recivedAnim=o.observable(!1).extend({autoResetToFalse:500}),this.published=o.observable(!1),this.isShared=o.observable(!1),this.fileName=o.observable(""),this.fullPath=o.observable(""),this.path=o.observable(""),this.storageType=o.observable(Enums.FileStorageType.Personal),this.displayName=o.observable(""),this.id=o.observable(""),this.sMainAction="list",this.oExtendedProps=null}a.prototype.parse=function(t){this.published(!!t.Published),this.fileName(s.pString(t.Name)),this.fullPath(s.pString(t.FullPath)),this.path(s.pString(t.Path)),this.storageType(s.pString(t.Type)),this.displayName(this.fileName()),this.id(s.pString(t.Id)),this.oExtendedProps=t.ExtendedProps||[],t.MainAction&&(this.sMainAction=s.pString(t.MainAction)),n.broadcastEvent("FilesWebclient::ParseFolder::after",[this,t])},a.prototype.getMainAction=function(){return this.sMainAction},a.prototype.eventDragStart=r.prototype.eventDragStart,t.exports=a},Pg7U:function(t,e,i){"use strict";var o=i("F/us"),s=i("0h2I"),n=i("wd/R"),r=i("RN+F"),a=i("AFLV"),l=i("Yjhd"),h=i("IAk5"),u=i("ZCBP"),c=i("cGGv"),p=i("5hOJ"),d=i("76Kh"),m=i("42lS"),f=window.Enums;function b(t,e){this.storageType=s.observable(a.pString(t.Type)),this.sLastModified=b.parseLastModified(t.LastModified),this.path=s.observable(a.pString(t.Path)),this.fullPath=s.observable(a.pString(t.FullPath)),this.selected=s.observable(!1),this.checked=s.observable(!1),this.bIsLink=!!t.IsLink,this.oExtendedProps=t.ExtendedProps,this.sLinkType=this.bIsLink?a.pString(t.LinkType):"",this.sLinkUrl=this.bIsLink?a.pString(t.LinkUrl):"",this.sThumbnailExternalLink=this.bIsLink?a.pString(t.ThumbnailUrl):"",this.deleted=s.observable(!1),this.recivedAnim=s.observable(!1).extend({autoResetToFalse:500}),this.published=s.observable(!1),this.sOwnerName=a.pString(t.Owner),c.call(this),this.content=s.observable(""),this.thumbUrlInQueueSubscribtion.dispose(),this.thumbUrlInQueue.subscribe((function(){""!==this.sThumbnailExternalLink?this.thumbnailSrc(this.sThumbnailExternalLink):this.bIsLink||this.getInThumbQueue()}),this),this.visibleCancelButton=s.computed((function(){return this.visibleProgress()&&100!==this.progressPercent()}),this),this.oActionsData.list={Text:r.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),Handler:o.bind((function(){h.broadcastEvent("Files::ShowList",{Item:this})}),this)},this.oActionsData.open={Text:r.i18n("COREWEBCLIENT/ACTION_OPEN_LINK"),Handler:o.bind(this.openLink,this)},this.iconAction(""),this.sHeaderText=o.bind((function(){if(this.sLastModified){var t=""!==this.sOwnerName?"FILESWEBCLIENT/INFO_OWNER_AND_DATA":"FILESWEBCLIENT/INFO_DATA";return r.i18n(t,{OWNER:this.sOwnerName,LASTMODIFIED:this.sLastModified})}return""}),this)(),this.type=this.storageType,this.canShare=s.computed((function(){return this.storageType()===f.FileStorageType.Personal||this.storageType()===f.FileStorageType.Corporate}),this),this.sHtmlEmbed=a.pString(t.OembedHtml),this.commonParseActions(t),this.cssClasses=s.computed((function(){var t=this.getCommonClasses();return this.allowDrag()&&t.push("dragHandle"),this.selected()&&t.push("selected"),this.checked()&&t.push("checked"),this.deleted()&&t.push("deleted"),this.allowPublicLink()&&this.published()&&t.push("published"),this.bIsLink&&t.push("aslink"),t.join(" ")}),this),this.parse(t,e)}o.extendOwn(b.prototype,c.prototype),b.parseLastModified=function(t){var e=new p;return t?(e.parse(t),e.getShortDate()):""},b.prepareLinkData=function(t,e){return{IsLink:!0,LinkType:t.LinkType,LinkUrl:e,Name:t.Name,Size:t.Size,ThumbnailUrl:t.Thumb}},b.prototype.parse=function(t,e){this.uploaded(!0),this.allowDrag(!e),this.allowUpload(!0),this.allowPublicLink(!0),this.allowActions(!e&&""!==this.fullPath()),this.fileName(a.pString(t.Name)),this.content(a.pString(t.Content)),this.id(a.pString(t.Id)),this.published(!!t.Published),this.size(a.pInt(t.Size)),this.hash(a.pString(t.Hash)),this.thumbUrlInQueue(""!==a.pString(t.ThumbnailUrl)?a.pString(t.ThumbnailUrl)+"/"+Math.random():""),this.mimeType(a.pString(t.ContentType)),this.bHasHtmlEmbed=!e&&""!==this.fullPath()&&"oembeded"===this.sLinkType,this.bHasHtmlEmbed&&this.iconAction("view"),this.isViewSupported()||this.bHasHtmlEmbed||this.actions(o.without(this.actions(),"view")),h.broadcastEvent("FilesWebclient::ParseFile::after",[this,t])},b.prepareUploadFileData=function(t,e,i,o){var s=t.FileName,r=l.getFileExtension(s),a=l.getFileNameWithoutExtension(s),u=0;for(""!==r&&(r="."+r);o(s);)s=a+"_"+u+r,u++;return t.FileName=s,{Name:s,LastModified:n().unix(),Owner:h.getUserPublicId(),Path:e,FullPath:e+"/"+s,Type:i,ContentType:t.Type,Size:t.Size}},b.prototype.viewFile=function(t,e){e&&(e.ctrlKey||e.shiftKey)||(""!==this.sHtmlEmbed?d.showPopup(m,[this.sHtmlEmbed]):this.bIsLink?this.viewCommonFile(this.sLinkUrl):this.viewCommonFile())},b.prototype.openLink=function(){this.bIsLink&&u.openTab(this.sLinkUrl)},t.exports=b},QFUI:function(t,e,i){"use strict";var o,s,n=i("RN+F"),r=i("76Kh"),a=i("1grR"),l=i("hPb3"),h={};h.getDownloadLink=function(t,e,i){return e.length>0?"?/Download/"+t+"/DownloadFile/"+e+"/"+(i?"0/"+i:""):""},h.getIframeWrappwer=function(t,e){return"?/Raw/Iframe/"+t+"/"+window.encodeURIComponent(e)+"/"},h.thumbQueue=(o={},s={},function(t,e,i){e&&i?!(t in s)||s[t]>0?(t in s||(s[t]=2,o[t]=[]),s[t]--,i(e)):o[t].push({imageSrc:e,imageSrcObserver:i,messageUid:t}):o[t]&&o[t].length&&(o[t][0].imageSrcObserver(o[t][0].imageSrc),o[t].shift())}),h.showErrorIfAttachmentSizeLimit=function(t,e){var i=n.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE_DETAILED",{FILENAME:t,MAXSIZE:n.getFriendlySize(l.AttachmentSizeLimit)});return l.AttachmentSizeLimit>0&&e>l.AttachmentSizeLimit&&(r.showPopup(a,[i]),!0)},t.exports=h},TX6J:function(t,e,i){"use strict";var o=i("F/us"),s=i("0h2I"),n=i("AFLV"),r=i("OgeD").run("AdminPanelWebclient","getAbstractSettingsFormViewClass"),a=i("Jq2H");function l(){r.call(this,a.ServerModuleName,"UpdateSettingsForEntity"),this.userSpaceLimitMb=s.observable(a.UserSpaceLimitMb),this.tenantSpaceLimitMb=s.observable(a.TenantSpaceLimitMb),this.sEntityType="",this.iEntityId=0,this.isSuperAdmin=s.observable(!1),this.isVisible=s.observable(!0)}o.extendOwn(l.prototype,r.prototype),l.prototype.ViewTemplate="FilesWebclient_FilesPersonalAdminSettingsView",l.prototype.getCurrentValues=function(){return[this.userSpaceLimitMb(),this.tenantSpaceLimitMb()]},l.prototype.revertGlobalValues=function(){this.userSpaceLimitMb(a.UserSpaceLimitMb),this.tenantSpaceLimitMb(a.TenantSpaceLimitMb)},l.prototype.getParametersForSave=function(){return{EntityType:this.sEntityType,EntityId:n.pInt(this.iEntityId),UserSpaceLimitMb:n.pInt(this.userSpaceLimitMb()),TenantSpaceLimitMb:n.pInt(this.tenantSpaceLimitMb())}},l.prototype.applySavedValues=function(t){a.updateAdminPersonal(t.UserSpaceLimitMb)},l.prototype.setAccessLevel=function(t,e){this.sEntityType=t,this.iEntityId="User"===t||"Tenant"===t?e:0,this.visible(""===t||"Tenant"===t||"User"===t),this.isSuperAdmin(""===t)},l.prototype.hide=function(){this.isVisible(!1)},t.exports=new l},c3Cn:function(t,e,i){"use strict";var o=i("F/us"),s=i("OgeD"),n=i("ZP6a"),r=s.run("SettingsWebclient","getAbstractSettingsFormViewClass"),a=i("Jq2H");function l(){r.call(this,"FilesWebclient"),this.bShowFilesApps=a.ShowFilesApps,this.sAppPath=n.getAppPath()}o.extendOwn(l.prototype,r.prototype),l.prototype.ViewTemplate="FilesWebclient_FilesSettingsFormView",t.exports=new l},cGGv:function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("0h2I"),r=i("IAk5"),a=i("QFUI"),l=i("RN+F"),h=i("AFLV"),u=i("ZP6a"),c=i("Yjhd"),p=i("ZCBP"),d=["image/jpeg","image/png","image/gif","text/html","text/plain","text/css","text/rfc822-headers","message/delivery-status","application/x-httpd-php","application/javascript"],m=[];function f(){this.id=n.observable(""),this.index=n.observable(0),this.fileName=n.observable(""),this.tempName=n.observable(""),this.displayName=n.observable(""),this.extension=n.observable(""),this.fileName.subscribe((function(t){this.id(t),this.displayName(t),this.extension(c.getFileExtension(t))}),this),this.size=n.observable(0),this.friendlySize=n.computed((function(){return this.size()>0?l.getFriendlySize(this.size()):""}),this),this.hash=n.observable(""),this.thumbUrlInQueue=n.observable(""),this.thumbUrlInQueueSubscribtion=this.thumbUrlInQueue.subscribe((function(){this.getInThumbQueue()}),this),this.thumbnailSrc=n.observable(""),this.thumbnailLoaded=n.observable(!1),this.thumbnailSessionUid=n.observable(""),this.mimeType=n.observable(""),this.uploadUid=n.observable(""),this.uploaded=n.observable(!1),this.uploadError=n.observable(!1),this.downloading=n.observable(!1),this.isViewMimeType=n.computed((function(){return-1!==s.inArray(this.mimeType(),d)}),this),this.bHasHtmlEmbed=!1,this.otherTemplates=n.observableArray([]),this.visibleCancelButton=n.observable(!0),this.statusText=n.observable(""),this.statusTooltip=n.computed((function(){return this.uploadError()?this.statusText():""}),this),this.progressPercent=n.observable(0),this.visibleProgress=n.observable(!1),this.uploadStarted=n.observable(!1),this.uploadStarted.subscribe((function(){this.uploadStarted()?(this.uploaded(!1),this.visibleProgress(!0),this.progressPercent(20)):(this.progressPercent(100),this.visibleProgress(!1),this.uploaded(!0))}),this),this.downloading.subscribe((function(){this.downloading()?this.visibleProgress(!0):(this.visibleProgress(!1),this.progressPercent(0))}),this),this.allowDrag=n.observable(!1),this.allowUpload=n.observable(!1),this.allowPublicLink=n.observable(!1),this.bIsSecure=n.observable(!1),this.isShared=n.observable(!1),this.sHeaderText="",this.oActionsData={view:{Text:l.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),Handler:o.bind((function(){this.viewFile()}),this)},download:{Text:l.i18n("COREWEBCLIENT/ACTION_DOWNLOAD_FILE"),Handler:o.bind((function(){this.downloadFile()}),this),Tooltip:n.computed((function(){var t=l.i18n("COREWEBCLIENT/INFO_CLICK_TO_DOWNLOAD_FILE",{FILENAME:this.fileName(),SIZE:this.friendlySize()});return""===this.friendlySize()&&(t=t.replace(" ()","")),t}),this)}},this.allowActions=n.observable(!0),this.iconAction=n.observable("download"),this.cssClasses=n.computed((function(){return this.getCommonClasses().join(" ")}),this),this.actions=n.observableArray([]),this.firstAction=n.computed((function(){return this.actions().length>1?this.actions()[0]:""}),this),this.secondAction=n.computed((function(){return 1===this.actions().length?this.actions()[0]:this.actions().length>1?this.actions()[1]:""}),this),this.subFiles=n.observableArray([]),this.subFilesExpanded=n.observable(!1)}s("html").hasClass("pdf")&&(d.push("application/pdf"),d.push("application/x-pdf")),f.prototype.addAction=function(t,e,i){e?this.actions.unshift(t):this.actions.push(t),this.actions(o.compact(this.actions())),i&&(this.oActionsData[t]=i)},f.prototype.removeAction=function(t){this.actions(o.without(this.actions(),t))},f.prototype.getMainAction=function(){return this.actions()[0]},f.prototype.hasAction=function(t){return-1!==o.indexOf(this.actions(),t)},f.prototype.getActionText=function(t){return this.hasAction(t)&&this.oActionsData[t]&&("string"==typeof this.oActionsData[t].Text||o.isFunction(this.oActionsData[t].Text))?o.isFunction(this.oActionsData[t].Text)?this.oActionsData[t].Text():this.oActionsData[t].Text:""},f.prototype.getActionUrl=function(t){return this.hasAction(t)&&this.oActionsData[t]&&this.oActionsData[t].Url||""},f.prototype.executeAction=function(t){this.hasAction(t)&&this.oActionsData[t]&&o.isFunction(this.oActionsData[t].Handler)&&this.oActionsData[t].Handler()},f.prototype.getTooltip=function(t){var e=this.hasAction(t)&&this.oActionsData[t]?this.oActionsData[t].Tooltip:"";return"string"==typeof e?e:o.isFunction(e)?e():""},f.prototype.getCommonClasses=function(){var t=[];return(this.allowUpload()&&!this.uploaded()||this.downloading())&&t.push("incomplete"),this.uploadError()?t.push("fail"):t.push("success"),t},f.prototype.parse=function(t){this.fileName(h.pString(t.FileName)),this.tempName(h.pString(t.TempName)),""===this.tempName()&&this.tempName(this.fileName()),this.mimeType(h.pString(t.MimeType)),this.size(t.EstimatedSize?h.pInt(t.EstimatedSize):h.pInt(t.SizeInBytes)),this.hash(h.pString(t.Hash)),this.parseActions(t),this.uploadUid(this.hash()),this.uploaded(!0),s.isFunction(this.additionalParse)&&this.additionalParse(t)},f.prototype.parseActions=function(t){this.thumbUrlInQueue(""!==h.pString(t.ThumbnailUrl)?h.pString(t.ThumbnailUrl)+"/"+Math.random():""),this.commonParseActions(t),this.commonExcludeActions()},f.prototype.commonExcludeActions=function(){this.isViewSupported()||this.actions(o.without(this.actions(),"view"))},f.prototype.commonParseActions=function(t){o.each(t.Actions,(function(t,e){this.oActionsData[e]||(this.oActionsData[e]={}),this.oActionsData[e].Url=h.pString(t.url),this.actions.push(e)}),this)},f.addViewExtensions=function(t){o.isArray(t)&&(m=o.union(m,t))},f.prototype.isViewSupported=function(){return-1!==s.inArray(this.mimeType(),d)||-1!==s.inArray(this.extension(),m)},f.prototype.getInThumbQueue=function(){""===this.thumbUrlInQueue()||this.linked&&(!this.linked||this.linked())||(this.thumbnailSessionUid(Date.now().toString()),a.thumbQueue(this.thumbnailSessionUid(),this.thumbUrlInQueue(),this.thumbnailSrc))},f.prototype.downloadFile=function(){var t=this.getActionUrl("download"),e={File:this,CancelDownload:!1};t.length>0&&"#"!==t&&(r.broadcastEvent("AbstractFileModel::FileDownload::before",e),e.CancelDownload||(o.isFunction(e.CustomDownloadHandler)?e.CustomDownloadHandler():u.downloadByUrl(t)))},f.prototype.viewFile=function(t,e){c.calmEvent(e),this.viewCommonFile()},f.prototype.viewCommonFile=function(t){var e=null,i=null;h.isNonEmptyString(t)||(t=u.getAppPath()+this.getActionUrl("view")),t.length>0&&"#"!==t&&(i={sUrl:t,index:this.index(),bBreakView:!1},r.broadcastEvent("AbstractFileModel::FileView::before",i),i.bBreakView||(e=p.open(t,t,!1))&&e.focus())},f.prototype.eventDragStart=function(t,e){var i=e.originalEvent||e;return t&&i&&i.dataTransfer&&i.dataTransfer.setData&&i.dataTransfer.setData("DownloadURL",this.generateTransferDownloadUrl()),!0},f.prototype.generateTransferDownloadUrl=function(){var t=this.getActionUrl("download");return"http"!==t.substr(0,4)&&(t=u.getAppPath()+t),this.mimeType()+":"+this.fileName()+":"+t},f.prototype.onUploadSelect=function(t,e,i){i||(this.fileName(h.pString(e.FileName)),this.mimeType(h.pString(e.Type)),this.size(h.pInt(e.Size))),this.uploadUid(t),this.uploaded(!1),this.statusText(""),this.progressPercent(0),this.visibleProgress(!1)},f.prototype.onUploadStart=function(){this.visibleProgress(!0)},f.prototype.onUploadProgress=function(t,e){e>0&&(this.progressPercent(Math.ceil(t/e*100)),this.visibleProgress(!0))},f.prototype.onDownloadProgress=function(t,e){e>0&&(this.progressPercent(Math.ceil(t/e*100)),this.visibleProgress(this.progressPercent()<100))},f.prototype.onUploadComplete=function(t,e,i){var o,s=!(e&&i&&!i.ErrorCode&&i.Result&&!i.Result.Error),n=i&&i.ErrorCode&&i.ErrorCode===Enums.Errors.CanNotUploadFileLimit?l.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE"):l.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN");this.progressPercent(0),this.visibleProgress(!1),this.uploaded(!0),this.uploadError(s),this.statusText(s?n:l.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),s||(this.fillDataAfterUploadComplete(i,t),setTimeout((o=this,function(){o.statusText("")}),3e3))},f.prototype.fillDataAfterUploadComplete=function(t,e){},f.prototype.onImageLoad=function(t,e){""===this.thumbUrlInQueue()||this.thumbnailLoaded()||(this.thumbnailLoaded(!0),a.thumbQueue(this.thumbnailSessionUid()))},f.prototype.stopDownloading=function(){this.downloading(!1)},f.prototype.startDownloading=function(){this.downloading(!0)},t.exports=f},dtb0:function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("0h2I"),r=i("RN+F"),a=i("AFLV"),l=i("Yjhd"),h=i("JFZZ"),u=i("IAk5"),c=i("mjrp"),p=i("kwPS"),d=i("QaF5"),m=i("SQrT"),f=i("hPb3"),b=i("xcwT"),y=i("76Kh"),g=i("1grR"),E=i("20Ah"),S=i("Au6d"),v=i("4KVt"),F=i("qsz4"),T=i("KM9R"),P=i("OgeD").run("MailWebclient","getComposeMessageWithAttachments"),C=i("p2SF"),L=i("+v/2"),A=i("Jq2H"),D=i("Pg7U"),I=i("MTJk"),w=window.Enums;function N(t){b.call(this,"FilesWebclient"),this.browserTitle=n.observable(r.i18n("FILESWEBCLIENT/HEADING_BROWSER_TAB")),this.bAllowSendEmails=o.isFunction(P),this.error=n.observable(!1),this.loaded=n.observable(!1),this.bPublic=u.isPublic(),this.storages=n.observableArray([]),this.folders=n.observableArray(),this.files=n.observableArray(),this.uploadingFiles=n.observableArray(),this.rootPath=n.observable(this.bPublic?A.PublicFolderName:r.i18n("FILESWEBCLIENT/LABEL_PERSONAL_STORAGE")),this.storageType=n.observable(w.FileStorageType.Personal),this.storageDisplayName=n.computed((function(){var t=this.getStorageByType(this.storageType());return t?t.displayName:""}),this),this.storageType.subscribe((function(){if(this.bPublic)this.rootPath(A.PublicFolderName);else{var t=this.getStorageByType(this.storageType());t?this.rootPath(t.displayName):"corporate"===this.storageType()&&this.rootPath(r.i18n("FILESWEBCLIENT/LABEL_CORPORATE_STORAGE")),this.selector.listCheckedAndSelected(!1)}}),this),this.pathItems=n.observableArray(),this.currentPath=n.observable(""),this.dropPath=n.observable(""),n.computed((function(){this.dropPath(this.currentPath())}),this),this.filesCollection=n.computed((function(){var t=o.union(this.files(),this.getUploadingFiles());return t.sort((function(t,e){return t.fileName()===e.fileName()?0:t.fileName()<e.fileName()?-1:1})),t}),this),this.collection=n.computed((function(){return o.union(this.folders(),this.filesCollection())}),this),this.columnCount=n.observable(1),this.selector=new p(this.collection,o.bind(this.onItemSelect,this),o.bind(this.onItemDelete,this),o.bind(this.onItemDblClick,this),o.bind(this.onEnter,this),this.columnCount,!0,!0,!0),this.firstSelectedFile=n.computed((function(){return o.find(this.selector.listCheckedAndSelected(),(function(t){return t instanceof D}))}),this),this.selectedCount=n.computed((function(){return this.selector.listCheckedAndSelected().length}),this),this.searchPattern=n.observable(""),this.newSearchPattern=n.observable(""),this.isSearchFocused=n.observable(!1),this.checkedReadyForOperations=n.computed((function(){return(this.selector.listCheckedAndSelected()||[]).every((function(t){return!(void 0!==t.uploaded&&!1===t.uploaded()||void 0!==t.downloading&&!0===t.downloading())}))}),this),this.renameCommand=l.createCommand(this,this.executeRename,(function(){return this.checkedReadyForOperations()&&1===this.selector.listCheckedAndSelected().length&&!this.isDisabledRenameButton()})),this.deleteCommand=l.createCommand(this,this.executeDelete,(function(){return this.checkedReadyForOperations()&&this.selector.listCheckedAndSelected().length>0&&!this.isDisabledDeleteButton()})),this.downloadCommand=l.createCommand(this,this.executeDownload,(function(){if(this.checkedReadyForOperations()){var t=this.getFileIfOnlyOneSelected();return!!t&&t.hasAction("download")}return!1})),this.shareCommand=l.createCommand(this,this.executeShare,(function(){var t=this.selector.listCheckedAndSelected();return this.checkedReadyForOperations()&&1===t.length&&!t[0].bIsLink})),this.sendCommand=l.createCommand(this,this.executeSend,(function(){if(this.checkedReadyForOperations()){var t=this.selector.listCheckedAndSelected();return o.filter(t,(function(t){return t instanceof D}),this).length>0}return!1})),this.uploaderButton=n.observable(null),this.uploaderArea=n.observable(null),this.bDragActive=n.observable(!1),this.bDragActiveComp=n.computed((function(){return this.bDragActive()&&""===this.searchPattern()}),this),this.bAllowDragNDrop=!1,this.uploadError=n.observable(!1),this.quota=n.observable(0),this.used=n.observable(0),this.quotaDesc=n.observable(""),this.quotaProc=n.observable(-1),this.aBottomLeftCornerLinks=A.BottomLeftCornerLinks,n.computed((function(){if(!f.ShowQuotaBar)return!0;var t=this.quota(),e=this.used(),i=0<t?Math.ceil(e/t*100):-1;i=100<i?100:i,this.quotaProc(i),this.quotaDesc(-1<i?r.i18n("COREWEBCLIENT/INFO_QUOTA",{PROC:i,QUOTA:r.getFriendlySize(t)}):""),f.QuotaWarningPerc>0&&-1!==i&&f.QuotaWarningPerc>100-i&&m.showError(r.i18n("COREWEBCLIENT/WARNING_QUOTA_ALMOST_REACHED"),!0)}),this),this.dragover=n.observable(!1),this.loading=n.observable(!1),this.loadedFiles=n.observable(!1),this.fileListInfoText=n.computed((function(){var t="";return this.loading()?t=r.i18n("COREWEBCLIENT/INFO_LOADING"):this.loadedFiles()?0===this.collection().length&&(""!==this.searchPattern()?t=r.i18n("FILESWEBCLIENT/INFO_NOTHING_FOUND"):""!==this.currentPath()||this.bInPopup||this.bPublic?t=r.i18n("FILESWEBCLIENT/INFO_FOLDER_IS_EMPTY"):this.bAllowDragNDrop&&(t=r.i18n("FILESWEBCLIENT/INFO_DRAGNDROP_FILES_OR_CREATE_FOLDER"))):this.error()&&(t=r.i18n("FILESWEBCLIENT/ERROR_FILES_NOT_RECEIVED")),t}),this),this.dragAndDropHelperBound=o.bind(this.dragAndDropHelper,this),this.bInPopup=!!t,this.isCurrentStorageExternal=n.computed((function(){var t=this.getStorageByType(this.storageType());return t&&t.isExternal}),this),this.timerId=null;var e={View:this,TemplateName:"FilesWebclient_ItemsView"};this.itemsViewTemplate=n.observable(e.TemplateName),u.broadcastEvent("Files::ChangeItemsView",e),this.addToolbarButtons=n.observableArray([]),u.subscribeEvent("Files::ShowList",o.bind((function(t){t.Item&&this.routeFiles(t.Item.storageType(),t.Item.fullPath())}),this)),u.broadcastEvent("FilesWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this}),E.opened.subscribe(o.bind((function(){this.shown()&&this.selector.useKeyboardKeys(!0)}),this)),this.createFolderButtonModules=n.observableArray([]),this.renameButtonModules=n.observableArray([]),this.deleteButtonModules=n.observableArray([]),this.shortcutButtonModules=n.observableArray([]),this.isDisabledCreateFolderButton=n.computed((function(){return this.createFolderButtonModules().length>0}),this),this.isDisabledRenameButton=n.computed((function(){return this.renameButtonModules().length>0}),this),this.isDisabledDeleteButton=n.computed((function(){return this.deleteButtonModules().length>0}),this),this.isDisabledShortcutButton=n.computed((function(){return this.shortcutButtonModules().length>0}),this),this.createFolderCommand=l.createCommand(this,this.executeCreateFolder,(function(){return!this.isDisabledCreateFolderButton()})),this.createShortcutCommand=l.createCommand(this,this.executeCreateShortcut,(function(){return!this.isDisabledShortcutButton()}))}o.extendOwn(N.prototype,b.prototype),N.prototype.ViewTemplate=u.isPublic()?"FilesWebclient_PublicFilesView":"FilesWebclient_FilesView",N.prototype.ViewConstructorName="CFilesView",N.prototype.onBind=function(t){var e=this.$viewDom||t;this.selector.initOnApplyBindings(".items_sub_list .item",".items_sub_list .selected.item",".items_sub_list .item .custom_checkbox",s(".panel.files .items_list",e),s(".panel.files .items_list .files_scroll.scroll-inner",e)),this.initUploader(),this.hotKeysBind()},N.prototype.hotKeysBind=function(){s(document).on("keydown",o.bind((function(t){this.shown()&&t&&t.keyCode===w.Key.s&&this.selector.useKeyboardKeys()&&!l.isTextFieldFocused()&&(t.preventDefault(),this.isSearchFocused(!0))}),this))},N.prototype.initUploader=function(){var t=this;!this.bPublic&&this.uploaderButton()&&this.uploaderArea()&&(this.oJua=new c({action:"?/Api/",name:"jua-uploader",queueSize:2,clickElement:this.uploaderButton(),hiddenElementsPosition:f.IsRTL?"right":"left",dragAndDropElement:this.uploaderArea(),disableAjaxUpload:!1,disableFolderDragAndDrop:!1,disableDragAndDrop:!1,hidden:o.extendOwn({Module:A.ServerModuleName,Method:"UploadFile",Parameters:function(e){return JSON.stringify({Type:t.storageType(),SubPath:e&&e.Folder||"",Path:t.dropPath()})}},u.getCommonRequestParameters())}),this.oJua.on("onProgress",o.bind(this.onFileUploadProgress,this)).on("onSelect",o.bind(this.onFileUploadSelect,this)).on("onStart",o.bind(this.onFileUploadStart,this)).on("onDrop",o.bind(this.onDrop,this)).on("onComplete",o.bind(this.onFileUploadComplete,this)).on("onBodyDragEnter",o.bind(this.bDragActive,this,!0)).on("onBodyDragLeave",o.bind(this.bDragActive,this,!1)).on("onCancel",o.bind(this.onCancelUpload,this)),this.bAllowDragNDrop=this.oJua.isDragAndDropSupported())},N.prototype.onFileUploadSelect=function(t,e){if(A.EnableUploadSizeLimit&&e.Size/1048576>A.UploadSizeLimitMb)return y.showPopup(g,[r.i18n("FILESWEBCLIENT/ERROR_SIZE_LIMIT",{FILENAME:e.FileName,SIZE:A.UploadSizeLimitMb})]),!1;if(this.storageType()===w.FileStorageType.Personal&&a.isPositiveNumber(this.quota())&&this.quota()>0&&this.used()+e.Size>this.quota())return y.showPopup(g,[r.i18n("COREWEBCLIENT/ERROR_CANT_UPLOAD_FILE_QUOTA")]),!1;if(""===this.searchPattern()){var i=D.prepareUploadFileData(e,this.currentPath(),this.storageType(),o.bind((function(t){return!!this.getFileByName(t)||!!o.find(this.getUploadingFiles(),(function(e){return e.fileName()===t}))}),this)),s=new D(i);s.onUploadSelect(t,e,!0),this.uploadingFiles.push(s)}},N.prototype.onFileUploadStart=function(t){var e=this.getUploadFileByUid(t);e&&e.onUploadStart()},N.prototype.onFileUploadProgress=function(t,e,i){if(""===this.searchPattern()){var o=this.getUploadFileByUid(t);o&&o.onUploadProgress(e,i)}},N.prototype.onFileUploadComplete=function(t,e,i){if(""===this.searchPattern()){var o=this.getUploadFileByUid(t),s=!1;o?(o.onUploadComplete(t,e,i),this.deleteUploadFileByUid(t),o.uploadError()?(this.uploadError(!0),i&&i.ErrorCode===w.Errors.CanNotUploadFileQuota?(y.showPopup(g,[r.i18n("COREWEBCLIENT/ERROR_CANT_UPLOAD_FILE_QUOTA")]),s=!0):i&&i.ErrorCode===w.Errors.FileAlreadyExists?(s=!0,m.showError(r.i18n("COREWEBCLIENT/ERROR_FILE_ALREADY_EXISTS"))):i&&i.ErrorCode===w.Errors.FileNotFound?(s=!0,m.showError(r.i18n("COREWEBCLIENT/ERROR_FILE_NOT_FOUND"))):m.showError(o.statusText())):(o.path()===this.currentPath()&&o.storageType()===this.storageType()&&this.files.push(o),0===this.uploadingFiles().length&&(m.showReport(r.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),s=!0))):s=!0,s&&this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)}},N.prototype.onDrop=function(t,e){if(!this.bPublic)if(e&&e.target&&""===this.searchPattern()){var i=n.dataFor(e.target);i&&i instanceof I&&this.dropPath(i.fullPath())}else m.showReport(r.i18n("FILESWEBCLIENT/INFO_CANNOT_UPLOAD_SEARCH_RESULT"))},N.prototype.filesDrop=function(t,e,i){if(e){var o=this.selector.listCheckedAndSelected(),s=e.ctrlKey?"Copy":"Move";this.moveItems(s,t,o)&&l.uiDropHelperAnim(e,i)}},N.prototype.moveItems=function(t,e,i){if(this.bPublic)return!1;var s="",n="",a=!0,l=e instanceof I?e.fullPath():"",h=[],u=e?e instanceof I?e.storageType():e.type:this.storageType(),c=this.getStorageByType(u),p=this.getStorageByType(this.storageType()),d=c.type===p.type,m=this.used(),f=this.quota();if(d||!d&&!c.isExternal&&!p.isExternal){if(c.type===w.FileStorageType.Personal&&p.type!==w.FileStorageType.Personal&&!o.every(i,(function(t){if(t instanceof D){if(f>0&&m+t.size()>f)return!1;m+=t.size()}return!0})))return y.showPopup(g,[r.i18n("FILESWEBCLIENT/ERROR_CANT_MOVE_FILES_QUOTA_PLURAL",{},"",i.length)]),!1;if(o.each(i,o.bind((function(e){(""!==s&&s!==e.path()||""!==n&&n!==e.storageType())&&(a=!1),s=e.path(),n=e.storageType(),e instanceof I&&l===s+"/"+e.id()||("Move"===t&&(e instanceof D?this.deleteFileByName(e.id()):this.deleteFolderByName(e.fileName())),h.push({FromType:n,FromPath:s,Name:e.id(),IsFolder:e instanceof I}))}),this)),h.length>0)return a||(n="",s=""),L.send(t,{FromType:n,ToType:u,FromPath:s,ToPath:l,Files:h},this.onMoveResponse,this),e instanceof I&&e.recivedAnim(!0),!0}return!1},N.prototype.onMoveResponse=function(t,e){t.Result?this.storageType()===e.Parameters.ToType&&this.currentPath()===e.Parameters.ToPath?this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern()):this.getQuota():(t.ErrorCode===w.Errors.CanNotUploadFileQuota?y.showPopup(g,[r.i18n("FILESWEBCLIENT/ERROR_CANT_MOVE_FILES_QUOTA_PLURAL",{},"",e.Parameters.Files.length)]):h.showErrorByCode(t,r.i18n("FILESWEBCLIENT/ERROR_FILES_MOVE_PLURAL",{},"",e.Parameters.Files.length)),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern()))},N.prototype.dragAndDropHelper=function(t){t&&t.checked(!0);var e=l.draggableItems(),i=this.selector.listCheckedAndSelected(),n=i.length,a=0,h=0,u="";return o.each(i,(function(t){t instanceof I?h++:a++}),this),0!==a&&0!==h?u=r.i18n("FILESWEBCLIENT/LABEL_DRAG_ITEMS_PLURAL",{COUNT:n},null,n):0===a?u=r.i18n("FILESWEBCLIENT/LABEL_DRAG_FOLDERS_PLURAL",{COUNT:h},null,h):0===h&&(u=r.i18n("FILESWEBCLIENT/LABEL_DRAG_FILES_PLURAL",{COUNT:a},null,a)),s(".count-text",e).text(u),e},N.prototype.onItemDelete=function(){var t=this.selector.listCheckedAndSelected(),e=t.every((function(t){return!(void 0!==t.uploaded&&!1===t.uploaded()||void 0!==t.downloading&&!0===t.downloading())}));0<t.length&&e&&this.executeDelete()},N.prototype.onItemSelect=function(t){u.isMobile()&&t instanceof I&&this.onItemDblClick(t)},N.prototype.onEnter=function(t){this.onItemDblClick(t)},N.prototype.onItemDblClick=function(t){if(t){var e=t.getMainAction();switch(e){case"view":t instanceof D&&(this.onSelectClickPopupBound?this.onSelectClickPopupBound():t.executeAction(e));break;case"list":this.routeFiles(t.storageType(),t.fullPath())}}},N.prototype.onGetFilesResponse=function(t,e){var i=t.Result,s=e.Parameters;if(this.bNotLoading=!1,(s.Type===this.storageType()||s.Hash===A.PublicHash)&&s.Path===this.currentPath())if(i){var n=[],a=[];o.each(i.Items,(function(t){if(t.IsFolder){var e=new I;e.parse(t),n.push(e)}else{var i=new D(t,this.bInPopup);i.oExtendedProps&&i.oExtendedProps.Loading&&(i.uploadError(!0),i.statusText(r.i18n("COREWEBCLIENT/LABEL_FILE_LOADING"))),i.index(a.length),a.push(i)}}),this),o.each(this.files(),(function(t,e,i){if(t.downloading()){var s=o.findIndex(a,(function(e){return t.fileName()===e.fileName()}));-1!==s&&(i[e].index(a[s].index()),a[s]=i[e])}})),this.folders(n),this.files(a),this.newSearchPattern(s.Pattern||""),this.searchPattern(s.Pattern||""),this.loadedFiles(!0),clearTimeout(this.timerId),this.parseQuota(i.Quota),o.isArray(i.Path)&&(this.pathItems.removeAll(),o.each(i.Path.reverse(),o.bind((function(t){var e=new I;e.parse(t),this.pathItems.push(e)}),this))),this.loading(!1),i.Access&&this.pathItems().length>0&&(this.pathItems()[this.pathItems().length-1].oExtendedProps?this.pathItems()[this.pathItems().length-1].oExtendedProps.Access||(this.pathItems()[this.pathItems().length-1].oExtendedProps.Access=i.Access,this.pathItems.valueHasMutated()):(this.pathItems()[this.pathItems().length-1].oExtendedProps={Access:i.Access},this.pathItems.valueHasMutated()))}else t.ErrorCode!==w.Errors.NotDisplayedError&&(this.loading(!1),this.error(!0))},N.prototype.parseQuota=function(t){t&&(this.quota(t.Limit),this.used(t.Used))},N.prototype.onDeleteResponse=function(t,e){t.Result?(this.expungeFileItems(),this.getQuota()):(h.showErrorByCode(t),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern()))},N.prototype.executeRename=function(){var t=o.first(this.selector.listCheckedAndSelected()),e=A.EditFileNameWithoutExtension&&t instanceof D,i=e?l.getFileNameWithoutExtension(t.fileName()):t.fileName(),s=e?l.getFileExtension(t.fileName()):"";!this.bPublic&&t&&y.showPopup(F,[i,o.bind(this.renameItem,this,s)])},N.prototype.renameItem=function(t,e){var i=""===t?e:e+"."+t,s=o.first(this.selector.listCheckedAndSelected());return l.validateFileOrFolderName(i)?(L.send("Rename",{Type:s.storageType(),Path:s.path(),Name:s.id()||s.fileName(),NewName:i,IsLink:s.bIsLink?1:0,IsFolder:s instanceof I},this.onRenameResponse,this),""):s instanceof I?r.i18n("FILESWEBCLIENT/ERROR_INVALID_FOLDER_NAME"):r.i18n("FILESWEBCLIENT/ERROR_INVALID_FILE_NAME")},N.prototype.getFileIfOnlyOneSelected=function(){var t=this.selector.listCheckedAndSelected();return 1===t.length&&t[0]instanceof D?t[0]:null},N.prototype.executeDownload=function(){var t=this.getFileIfOnlyOneSelected();t&&t.executeAction("download")},N.prototype.executeShare=function(){var t=o.first(this.selector.listCheckedAndSelected());!this.bPublic&&t&&y.showPopup(T,[t])},N.prototype.executeSend=function(){var t=this.selector.listCheckedAndSelected(),e=o.filter(t,(function(t){return t instanceof D}),this),i=o.map(e,(function(t){return{Storage:t.storageType(),Path:t.path(),Name:t.fileName(),Id:t.id()}}));this.bAllowSendEmails&&e.length>0&&L.send("SaveFilesAsTempFiles",{Files:i},(function(t){t.Result&&P(t.Result)}),this)},N.prototype.onShareIconClick=function(t){t&&y.showPopup(T,[t])},N.prototype.onRenameResponse=function(t,e){t.Result||h.showErrorByCode(t,r.i18n("FILESWEBCLIENT/ERROR_FILE_RENAME")),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},N.prototype.refresh=function(){this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},N.prototype.executeDelete=function(){var t=this.selector.listCheckedAndSelected()||[],e=t.length,i=!!o.find(t,(function(t){return t instanceof I})),s=!!o.find(t,(function(t){return!(t instanceof I)})),n="";n=i&&s?r.i18n("FILESWEBCLIENT/CONFIRM_DELETE_ITEMS_PLURAL",{COUNT:e},null,e):i?r.i18n("FILESWEBCLIENT/CONFIRM_DELETE_FOLDERS_PLURAL",{COUNT:e},null,e):r.i18n("FILESWEBCLIENT/CONFIRM_DELETE_FILES_PLURAL",{COUNT:e},null,e),!this.bPublic&&e>0&&(this.selector.useKeyboardKeys(!1),y.showPopup(E,[n,o.bind(this.deleteItems,this,t),"",r.i18n("COREWEBCLIENT/ACTION_DELETE")]))},N.prototype.onShow=function(){this.loaded(!0),this.bPublic||this.requestStorages(),this.selector.useKeyboardKeys(!0),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!0)},N.prototype.onHide=function(){this.selector.useKeyboardKeys(!1),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!1)},N.prototype.getQuota=function(){L.send("GetQuota",{Type:this.storageType()},(function(t){t.Result&&this.parseQuota(t.Result)}),this)},N.prototype.getStorageByType=function(t){return o.find(this.storages(),(function(e){return e.type===t}))},N.prototype.requestStorages=function(){L.send("GetStorages",null,this.onGetStoragesResponse,this)},N.prototype.onGetStoragesResponse=function(t,e){var i=t.Result;i&&(o.each(i,(function(t){t.Type&&!this.getStorageByType(t.Type)&&this.storages.push({isExternal:t.IsExternal,type:t.Type,displayName:t.DisplayName,droppable:a.pBool(t.IsDroppable,!0)})}),this),this.expungeExternalStorages(o.map(i,(function(t){return t.Type}),this))),this.getStorageByType(this.storageType())||(this.storageType(w.FileStorageType.Personal),this.pathItems.removeAll())},N.prototype.showLoading=function(){this.folders([]),this.files([]),this.loading(!0)},N.prototype.routeFiles=function(t,e,i,o){var s=!1;this.bPublic?d.setHash(C.getFiles("",e,""))&&(this.showLoading(),L.send("GetPublicFiles",{Hash:A.PublicHash,Path:this.currentPath()},this.onGetFilesResponse,this)):(this.bNotLoading=o,this.bInPopup?this.onUserRoute(C.getParsedParams(t,e,i)):d.setHash(C.getFiles(t,e,i))&&(this.showLoading(),s=""!==this.currentPath()&&0===this.pathItems().length,L.send("GetFiles",{Type:this.storageType(),Path:this.currentPath(),Pattern:this.searchPattern(),PathRequired:s},this.onGetFilesResponse,this),s&&this.showLoading()))},N.prototype.addPathItems=function(t,e,i){var o=new I;o.storageType(t),o.displayName(i),o.fileName(i),o.path(e),o.fullPath(e),this.pathItems.unshift(o)},N.prototype.onRoute=function(t){var e=C.parseFiles(t);this.bPublic?this.onPublicRoute(e):this.onUserRoute(e)},N.prototype.onUserRoute=function(t){var e=0===this.storages().length||!!o.find(this.storages(),(function(e){return e.type===t.Storage}))?t.Storage:this.storages().length>0?this.storages()[0].type:"",i=t.Path,s=t.PathParts.reverse(),n=o.find(this.folders(),(function(t){return t.fullPath()===i})),r=o.findIndex(this.pathItems(),(function(t){return t.fullPath()===i})),l=[],h=!1;this.error(!1),this.storageType(e),this.currentPath(i),this.loadedFiles(!1),-1!==r?(o.each(this.pathItems(),(function(t,e){e<=r&&l.push(t)})),this.pathItems.removeAll(),this.pathItems(l)):n?this.pathItems.push(n):"google"!==e||""===i?(this.pathItems.removeAll(),o.each(s,o.bind((function(t){var o=i.lastIndexOf(t);this.addPathItems(e,i,t),i=i.substr(0,o)}),this))):h=!0,this.bNotLoading&&(this.files().length>0||this.folders().length>0)?this.timerId=setTimeout(o.bind((function(){this.loadedFiles()||this.error()||this.showLoading()}),this),3e3):this.showLoading(),L.send("GetFiles",{Type:e,Path:t.Path,Pattern:a.pString(t.Search),PathRequired:h},this.onGetFilesResponse,this)},N.prototype.onPublicRoute=function(t){var e=t.Path,i=t.PathParts.reverse(),s="";this.currentPath(e),this.pathItems.removeAll(),o.each(i,o.bind((function(i){var o=e.lastIndexOf(i);this.addPathItems(t.Storage,e,i),e=e.substr(0,o),s=i}),this)),s!==this.rootPath()&&this.addPathItems(t.Storage,"",this.rootPath()),this.showLoading(),L.send("GetPublicFiles",{Hash:A.PublicHash,Path:this.currentPath()},this.onGetFilesResponse,this)},N.prototype.deleteItems=function(t,e){var i=this.storageType(),s=this.currentPath();if(e&&0<t.length){var n=o.compact(o.map(t,(function(t){return""!==t.id()?(t.deleted(!0),i=t.storageType(),{Path:t.path(),Name:t.id(),IsFolder:t instanceof I}):null})));n.length&&L.send("Delete",{Type:i,Path:s,Items:n},this.onDeleteResponse,this)}},N.prototype.getFileByName=function(t){return o.find(this.files(),(function(e){return e.fileName()===t}))},N.prototype.deleteFileByName=function(t){this.files(o.filter(this.files(),(function(e){return e.id()!==t})))},N.prototype.deleteFolderByName=function(t){this.folders(o.filter(this.folders(),(function(e){return e.fileName()!==t})))},N.prototype.expungeFileItems=function(){this.folders(o.filter(this.folders(),(function(t){return!t.deleted()}),this)),this.files(o.filter(this.files(),(function(t){return!t.deleted()}),this))},N.prototype.expungeExternalStorages=function(t){this.storages(o.filter(this.storages(),(function(e){return!e.isExternal||o.include(t,e.type)}),this))},N.prototype.getUploadFileByUid=function(t){return o.find(this.uploadingFiles(),(function(e){return e.uploadUid()===t}))},N.prototype.deleteUploadFileByUid=function(t){this.uploadingFiles(o.filter(this.uploadingFiles(),(function(e){return e.uploadUid()!==t})))},N.prototype.getUploadingFiles=function(){return o.filter(this.uploadingFiles(),o.bind((function(t){return t.path()===this.currentPath()&&t.storageType()===this.storageType()}),this))},N.prototype.onCancelUpload=function(t){this.deleteUploadFileByUid(t),this.oJua&&this.oJua.cancel(t)},N.prototype.onCreateFolderResponse=function(t,e){t.Result||h.showErrorByCode(t),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},N.prototype.createFolder=function(t){return t=s.trim(t),l.validateFileOrFolderName(t)?(L.send("CreateFolder",{Type:this.storageType(),Path:this.currentPath(),FolderName:t},this.onCreateFolderResponse,this),""):r.i18n("FILESWEBCLIENT/ERROR_INVALID_FOLDER_NAME")},N.prototype.executeCreateFolder=function(){y.showPopup(S,[o.bind(this.createFolder,this)])},N.prototype.onCreateLinkResponse=function(t,e){this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},N.prototype.createLink=function(t){L.send("CreateLink",{Type:this.storageType(),Path:this.currentPath(),Link:t.sLinkUrl,Name:t.fileName()},this.onCreateLinkResponse,this)},N.prototype.executeCreateShortcut=function(){var t=o.bind(this.createLink,this);y.showPopup(v,[t])},N.prototype.onSearch=function(){this.routeFiles(this.storageType(),this.currentPath(),this.newSearchPattern())},N.prototype.clearSearch=function(){this.routeFiles(this.storageType(),this.currentPath())},N.prototype.getCurrentFolder=function(){var t=new I;return t.fullPath(this.currentPath()),t.storageType(this.storageType()),t},N.prototype.registerToolbarButtons=function(t){a.isNonEmptyArray(t)&&(o.each(t,o.bind((function(t){o.isFunction(t.useFilesViewData)&&t.useFilesViewData(this)}),this)),this.addToolbarButtons(o.union(this.addToolbarButtons(),t)))},N.prototype.onFileRemove=function(t,e){var i=o.bind((function(t,e){var i=[{Path:this.currentPath(),Name:e,IsFolder:!1}];L.send("Delete",{Type:this.storageType(),Path:this.currentPath(),Items:i},o.bind((function(){var t=""!==this.currentPath()&&0===this.pathItems().length;L.send("GetFiles",{Type:this.storageType(),Path:this.currentPath(),Pattern:this.searchPattern(),PathRequired:t},this.onGetFilesResponse,this)}),this)),this.onCancelUpload(t)}),this);if(e.downloading())u.broadcastEvent("CFilesView::FileDownloadCancel",{oFile:e});else if(!e.uploaded()&&t){u.broadcastEvent("CFilesView::FileUploadCancel",{sFileUploadUid:t,sFileUploadName:e.fileName(),fOnUploadCancelCallback:i})||i(t,e.fileName())}},N.prototype.disableButton=function(t,e){-1===t.indexOf(e)&&t.push(e)},N.prototype.enableButton=function(t,e){t.remove(e)},t.exports=N},kbJU:function(t,e,i){"use strict";var o=i("F/us"),s={FileStorageType:{Personal:"personal",Corporate:"corporate",Shared:"shared",GoogleDrive:"google",Dropbox:"dropbox"},FileStorageLinkType:{Unknown:0,GoogleDrive:1,Dropbox:2,YouTube:3,Vimeo:4,SoundCloud:5}};void 0===window.Enums&&(window.Enums={}),o.extendOwn(window.Enums,s)},kwPS:function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("0h2I"),r=i("AFLV"),a=i("Yjhd"),l=i("IAk5"),h=i("HLSX"),u=i("76Kh");function c(t,e,i,a,h,u,c,p,d,m,f){this.fSelectCallback=e||function(){},this.fDeleteCallback=i||function(){},this.fDblClickCallback=!l.isMobile()&&a?a:function(){},this.fEnterCallback=h||function(){},this.bResetCheckedOnClick=!!c,this.bCheckOnSelect=!!p,this.bUnselectOnCtrl=!!d,this.bDisableMultiplySelection=!!m,this.bChangeOnSelect=void 0===f||!!f,this.useKeyboardKeys=n.observable(!1),this.list=n.observableArray([]),t&&t.subscribe&&t.subscribe((function(t){this.list(t)}),this),this.multiplyLineFactor=u,this.oLast=null,this.oListScope=null,this.oScrollScope=null,this.iTimer=0,this.iFactor=1,this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Up,this.KeyRight=Enums.Key.Down,this.multiplyLineFactor&&(this.multiplyLineFactor.subscribe?this.multiplyLineFactor.subscribe((function(t){this.iFactor=0<t?t:1}),this):this.iFactor=r.pInt(this.multiplyLineFactor),this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Left,this.KeyRight=Enums.Key.Right,s("html").hasClass("rtl")&&(this.KeyLeft=Enums.Key.Right,this.KeyRight=Enums.Key.Left)),this.sActionSelector="",this.sSelectabelSelector="",this.sCheckboxSelector="";var b=this;this.listChecked=n.computed({read:function(){return o.filter(this.list(),(function(t){var e=t.checked(),i=t.selected();return e||b.bCheckOnSelect&&i}))},write:function(t){t=!!t,o.each(this.list(),(function(e){e.checked(t)})),this.list.valueHasMutated()},owner:this}),this.checkAll=n.computed({read:function(){return 0<this.listChecked().length},write:function(t){this.listChecked(!!t)},owner:this}),this.selectorHook=n.observable(null),this.selectorHook.subscribe((function(){var t=this.selectorHook();t&&o.isFunction(t.selected)&&t.selected(!1)}),this,"beforeChange"),this.selectorHook.subscribe((function(t){t&&t.selected(!0)}),this),this.itemSelected=n.computed({read:this.selectorHook,write:function(t){this.selectorHook(t),t&&(b.scrollToSelected(),this.oLast=t)},owner:this}),this.list.subscribe((function(t){if(o.isArray(t)){var e=this.itemSelected();e&&(o.find(t,(function(t){return e===t}))||this.itemSelected(null))}else this.itemSelected(null)}),this),this.listCheckedOrSelected=n.computed({read:function(){var t=this.itemSelected(),e=this.listChecked();return 0<e.length?e:t?[t]:[]},write:function(t){t?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.listCheckedAndSelected=n.computed({read:function(){var t=[],e=this.itemSelected(),i=this.listChecked();return i&&(t=i.slice(0)),e&&-1===o.indexOf(i,e)&&t.push(e),t},write:function(t){t?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.isIncompleteChecked=n.computed((function(){var t=this.list().length,e=this.listChecked().length;return 0<t&&0<e&&t>e}),this),this.onKeydownBound=o.bind(this.onKeydown,this)}c.prototype.iTimer=0,c.prototype.bResetCheckedOnClick=!1,c.prototype.bCheckOnSelect=!1,c.prototype.bUnselectOnCtrl=!1,c.prototype.bDisableMultiplySelection=!1,c.prototype.getLastOrSelected=function(){var t=0,e=null;return o.each(this.list(),(function(i){i.checked()&&t++,i.selected()&&(e=i)})),0===t&&e?e:this.oLast},c.prototype.initOnApplyBindings=function(t,e,i,o,r){s(document).on("keydown",this.onKeydownBound),this.oListScope=o,this.oScrollScope=r,this.sActionSelector=t,this.sSelectabelSelector=e,this.sCheckboxSelector=i;var a=this,l=function(t,e,i){var o=0,s=0,n=null,r=!1,l=!1,h=[],u=!1;if(e=e||null,i&&i.shiftKey&&null!==e&&null!==t&&e!==t)for(h=a.list(),u=e.checked(),o=0,s=h.length;o<s;o++)r=!1,(n=h[o])!==t&&n!==e||(r=!0),r&&(l=!l),(l||r)&&n.checked(u);e&&(a.oLast=e)};s(this.oListScope).on("dblclick",t,(function(t){var e=n.dataFor(this);!e||!t||t.ctrlKey||t.altKey||t.shiftKey||a.onDblClick(e)})),h.mobileDevice&&s(this.oListScope).on("touchstart",t,(function(t){if(t){var e=t.timeStamp,i=e-(s(this).data("lastTouch")||e),o=t.originalEvent&&t.originalEvent.touches?t.originalEvent.touches.length:0;s(this).data("lastTouch",e),!i||i>250||o>1||(t.preventDefault(),s(this).trigger("dblclick"))}})),s(this.oListScope).on("click",t,(function(t){var e=!0,i=null,o=a.getLastOrSelected(),s=n.dataFor(this);s&&t&&(t.shiftKey?(e=!1,a.bDisableMultiplySelection||(null===a.oLast&&(a.oLast=s),s.checked(!s.checked()),l(o,s,t))):t.ctrlKey&&(e=!1,a.bDisableMultiplySelection||(a.oLast=s,!(i=a.itemSelected())||i.checked()||s.checked()||i.checked(!0),a.bUnselectOnCtrl&&s===a.itemSelected()?(s.checked(!s.selected()),a.itemSelected(null)):s.checked(!s.checked()))),e&&a.selectionFunc(s))})),s(this.oListScope).on("click",i,(function(t){var e=n.dataFor(this);e&&t&&!a.bDisableMultiplySelection&&(t.shiftKey?(null===a.oLast&&(a.oLast=e),l(a.getLastOrSelected(),e,t)):a.oLast=e),t&&t.stopPropagation&&t.stopPropagation()})),s(this.oListScope).on("dblclick",i,(function(t){t&&t.stopPropagation&&t.stopPropagation()}))},c.prototype.getResultSelection=function(t,e){var i=this,n=!1,r=!1,a=null,l=this.iFactor,h=!!this.multiplyLineFactor,u=0,c=0,p=[];if(!t&&-1<s.inArray(e,[this.KeyUp,this.KeyDown,this.KeyLeft,this.KeyRight,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]))(p=this.list())&&0<p.length&&(-1<s.inArray(e,[this.KeyDown,this.KeyRight,Enums.Key.PageUp,Enums.Key.Home])?a=p[0]:-1<s.inArray(e,[this.KeyUp,this.KeyLeft,Enums.Key.PageDown,Enums.Key.End])&&(a=p[p.length-1]));else if(t&&0<(c=(p=this.list())?p.length:0))if(Enums.Key.Home===e||Enums.Key.PageUp===e||Enums.Key.End===e||Enums.Key.PageDown===e||h&&(Enums.Key.Left===e||Enums.Key.Right===e)||!h&&(Enums.Key.Up===e||Enums.Key.Down===e))o.each(p,(function(o){if(!n)switch(e){case i.KeyUp:case i.KeyLeft:t===o?n=!0:a=o;break;case Enums.Key.Home:case Enums.Key.PageUp:a=o,n=!0;break;case i.KeyDown:case i.KeyRight:r?(a=o,n=!0):t===o&&(r=!0);break;case Enums.Key.End:case Enums.Key.PageDown:a=o}}));else if(h&&this.KeyDown===e){for(;u<c;u++)if(t===p[u]){c-1<(u+=l)&&(u-=l),a=p[u];break}}else if(h&&this.KeyUp===e)for(u=c;u>=0;u--)if(t===p[u]){0>(u-=l)&&(u+=l),a=p[u];break}return a},c.prototype.shiftClickResult=function(t,e,i){if(e){var n=!!this.multiplyLineFactor,r=!1,a=!1;-1<s.inArray(i,n?[Enums.Key.Left,Enums.Key.Right]:[Enums.Key.Up,Enums.Key.Down])?e.checked(!e.checked()):-1<s.inArray(i,n?[Enums.Key.Up,Enums.Key.Down,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]:[Enums.Key.Left,Enums.Key.Right,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End])&&(a=!e.checked(),o.each(this.list(),(function(i){var o=!1;i!==t&&e!==i||(r=!r,o=!0),(r||o)&&(i.checked(a),o=!1)})),n&&t&&(i===Enums.Key.Up||i===Enums.Key.Down)&&t.checked(!t.checked()))}},c.prototype.clickNewSelectPosition=function(t,e){var i=this.itemSelected(),o=this.getResultSelection(i,t);o&&(e&&this.shiftClickResult(o,i,t),this.selectionFunc(o))},c.prototype.onKeydown=function(t){var e=!0,i=0;return this.useKeyboardKeys()&&t&&!a.isTextFieldFocused()&&!u.hasOpenedMaximizedPopups()&&(i=t.keyCode,t.ctrlKey||this.KeyUp!==i&&this.KeyDown!==i&&this.KeyLeft!==i&&this.KeyRight!==i&&Enums.Key.PageUp!==i&&Enums.Key.PageDown!==i&&Enums.Key.Home!==i&&Enums.Key.End!==i?Enums.Key.Del!==i||t.ctrlKey||t.shiftKey?Enums.Key.Enter===i?0<this.list().length&&!t.ctrlKey&&(this.onEnter(this.itemSelected()),e=!1):!t.ctrlKey||t.altKey||t.shiftKey||Enums.Key.a!==i||(this.checkAll(!(this.checkAll()&&!this.isIncompleteChecked())),e=!1):0<this.list().length&&(this.onDelete(),e=!1):(this.clickNewSelectPosition(i,t.shiftKey),e=!1)),e},c.prototype.onDelete=function(){this.fDeleteCallback.call(this,this.listCheckedOrSelected())},c.prototype.onEnter=function(t){this.fEnterCallback.call(this,t)},c.prototype.selectionFunc=function(t){this.bChangeOnSelect&&this.itemSelected(null),this.bResetCheckedOnClick&&this.listChecked(!1),this.bChangeOnSelect&&this.itemSelected(t),this.fSelectCallback.call(this,t)},c.prototype.onDblClick=function(t){this.fDblClickCallback.call(this,t)},c.prototype.koCheckAll=function(){return n.computed({read:this.checkAll,write:this.checkAll,owner:this})},c.prototype.koCheckAllIncomplete=function(){return n.computed({read:this.isIncompleteChecked,write:this.isIncompleteChecked,owner:this})},c.prototype.scrollToSelected=function(){if(!this.oListScope||!this.oScrollScope)return!1;var t=s(this.sSelectabelSelector,this.oScrollScope),e=t.position(),i=this.oScrollScope.height(),o=t.outerHeight();return!(!e||!(e.top<0||e.top+o>i))&&(e.top<0?this.oScrollScope.scrollTop(this.oScrollScope.scrollTop()+e.top-20):this.oScrollScope.scrollTop(this.oScrollScope.scrollTop()+e.top-i+o+20),!0)},t.exports=c},mjrp:function(t,e,i){"use strict";var o=i("EVdn"),s=i("F/us"),n=i("0h2I"),r=i("w+bY"),a=i("AFLV"),l=i("IAk5"),h=20;function u(t){return void 0===t}function c(t){0<t&&clearTimeout(t),t=0}function p(t){return(t=t&&(t.originalEvent?t.originalEvent:t)||window.event).dataTransfer?t:null}function d(t,e,i){return t&&e&&!u(t[e])?t[e]:i}function m(t,e,i){t[e]=i}function f(){return"jua-uid-"+function(t){var e="",i="0123456789abcdefghijklmnopqrstuvwxyz";for(t=u(t)?32:a.pInt(t);e.length<t;)e+=i.substr(Math.round(Math.random()*i.length),1);return e}(16)+"-"+(new Date).getTime().toString()}function b(t,e){return{FileName:u(t.fileName)?u(t.name)?null:t.name:t.fileName,Size:u(t.fileSize)?u(t.size)?null:t.size:t.fileSize,Type:u(t.type)?null:t.type,Folder:u(e)?"":e,File:t}}function y(t,e,i,o,s,n){var r=0,l=0,c=0,p=null,d=null,m=!1,f=!1,y=function(t,e,i,l){if(t&&!u(t.name))if(e=e||"",t.isFile)t.file((function(t){!m||0<=--s?i(b(t,e)):m&&!f&&0>s&&n&&(f=!0,n(r))}));else if(o&&t.isDirectory&&t.createReader){var h=t.createReader(),c=0,p=0;h&&h.readEntries&&h.readEntries((function(o){if(o&&a.isNonEmptyArray(o))for(c=0,p=o.length;c<p;c++)y(o[c],e+t.name+"/",i,l)}))}};if(o=!!u(o)||!!o,i=!u(i)&&!!i,s=u(s)?h:a.pInt(s),r=s,m=0<s,t=t&&0<t.length?t:null)for(c=0,l=t.length;c<l;c++)(p=t[c])&&(i?"file"===p.kind&&p.webkitGetAsEntry&&(d=p.webkitGetAsEntry())&&y(d,"",e,n):!m||0<=--s?e(b(p)):m&&!f&&0>s&&n&&(f=!0,n(r)))}function g(t,e,i,o){var s=t&&t.files&&0<t.files.length?t.files:null;s?y(s,e,!1,!1,i,o):e({FileName:t.value.split("\\").pop().split("/").pop(),Size:null,Type:null,Folder:"",File:null})}function E(t){var e=!1;if(t&&t.dataTransfer&&t.dataTransfer.types&&t.dataTransfer.types.length)for(var i=0,o=t.dataTransfer.types.length;i<o;i++)if("files"===t.dataTransfer.types[i].toLowerCase()){e=!0;break}return e}function S(){return o('<label style="position: absolute; background-color:#fff; right: 0px; top: 0px; left: 0px; bottom: 0px; margin: 0px; padding: 0px; cursor: pointer;"></label>').css({opacity:0})}function v(t,e,i,s){t=u(t)?"":t.toString();var n=function(t,e){return""!==e&&(e=' accept="'+e+'"'),o('<input type="file" tabindex="-1" hidefocus="hidefocus" style="position: absolute; '+t+': -9999px;"'+e+" />")}(i=u(i)?"left":i.toString(),s=u(s)?"":s.toString());return 0<t.length&&n.attr("name",t),(u(e)||e)&&n.prop("multiple",!0),n}function F(t,e){return a.pString(s.isFunction(t)?t.apply(null,s.isArray(e)?e:[]):t)}function T(t,e){this.oXhrs={},this.oUids={},this.oJua=t,this.oOptions=e}function P(t,e){this.oUids={},this.oForms={},this.oJua=t,this.oOptions=e}function C(t){t=u(t)?{}:t;var e=this;e.bEnableDnD=!0,e.bEnableButton=!0,e.oEvents={onDialog:null,onSelect:null,onStart:null,onComplete:null,onCompleteAll:null,onProgress:null,onDragEnter:null,onDragLeave:null,onDrop:null,onBodyDragEnter:null,onBodyDragLeave:null,onLimitReached:null},e.oOptions=s.extend({action:"",name:"",hidden:{},queueSize:10,clickElement:!1,dragAndDropElement:!1,dragAndDropBodyElement:!1,disableAjaxUpload:!1,disableFolderDragAndDrop:!0,disableDragAndDrop:!1,disableMultiple:!1,disableDocumentDropPrevent:!1,disableAutoUploadOnDrop:!1,multipleSizeLimit:50,hiddenElementsPosition:"left"},t),e.oQueue=r(a.pInt(d(e.oOptions,"queueSize",10))),e.runEvent("onCompleteAll")&&e.oQueue.await((function(){e.runEvent("onCompleteAll")})),e.oDriver=e.isAjaxUploaderSupported()&&!d(e.oOptions,"disableAjaxUpload",!1)?new T(e,e.oOptions):new P(e,e.oOptions),e.oClickElement=d(e.oOptions,"clickElement",null),e.oClickElement&&(o(e.oClickElement).css({position:"relative",overflow:"hidden"}),"inline"===o(this.oClickElement).css("display")&&o(this.oClickElement).css("display","inline-block"),this.oDriver.generateNewInput(this.oClickElement)),this.oDriver.isDragAndDropSupported()&&d(this.oOptions,"dragAndDropElement",!1)&&!d(this.oOptions,"disableAjaxUpload",!1)?function(t){var e=o(document),i=o(d(t.oOptions,"dragAndDropBodyElement",!1)||e),s=d(t.oOptions,"dragAndDropElement",!1);s&&(d(t.oOptions,"disableDocumentDropPrevent",!1)||e.on("dragover",(function(e){if(t.bEnableDnD&&e&&(e=p(e))&&e.dataTransfer&&E(e))try{e.dataTransfer.dropEffect="none",e.preventDefault()}catch(t){}})),i&&i[0]&&i.on("dragover",(function(e){t.bEnableDnD&&e&&c(t.iDocTimer)})).on("dragenter",(function(e){t.bEnableDnD&&e&&(e=p(e))&&E(e)&&(c(t.iDocTimer),e.preventDefault(),t.runEvent("onBodyDragEnter",[e]))})).on("dragleave",(function(e){t.bEnableDnD&&e&&(e=p(e))&&(c(t.iDocTimer),t.iDocTimer=setTimeout((function(){t.runEvent("onBodyDragLeave",[e])}),200))})).on("drop",(function(e){if(t.bEnableDnD&&e&&(e=p(e))){var i=E(e);return i&&e.preventDefault(),t.runEvent("onBodyDragLeave",[e]),!i}return!1})),o(s).bind("dragenter",(function(e){t.bEnableDnD&&e&&(e=p(e))&&E(e)&&(c(t.iDocTimer),e.preventDefault(),t.runEvent("onDragEnter",[s,e]))})).bind("dragover",(function(e){if(t.bEnableDnD&&e&&(e=p(e))&&e.dataTransfer&&E(e))try{var o=e.dataTransfer.effectAllowed;c(t.iDocTimer),e.dataTransfer.dropEffect="move"===o||"linkMove"===o?"move":"copy",e.stopPropagation(),e.preventDefault(),i.trigger("dragover",e)}catch(t){}})).bind("dragleave",(function(e){if(t.bEnableDnD&&e){if(e=p(e)){var i=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;if(i&&(n=i,r=!1,(o=this)&&n&&(r=o===n||(o.contains?o.contains(n):!!n.compareDocumentPosition&&!!(8&n.compareDocumentPosition(o)))),r))return;c(t.iDocTimer),t.runEvent("onDragLeave",[s,e])}}else var o,n,r})).bind("drop",(function(e){t.bEnableDnD&&e&&(e=p(e))&&E(e)&&(e.preventDefault(),function(t,e,i,o,s){var n=null,r=null;(t=p(t))&&((n=(t.dataTransfer?d(t.dataTransfer,"items",null):null)||d(t,"items",null))&&0<n.length&&n[0]&&n[0].webkitGetAsEntry?y(n,e,!0,s,i,o):E(t)&&(r=d(t,"files",null)||(t.dataTransfer?d(t.dataTransfer,"files",null):null))&&0<r.length&&y(r,e,!1,!1,i,o))}(e,(function(i){i&&(d(t.oOptions,"disableAutoUploadOnDrop",!1)?t.runEvent("onDrop",[i,e,function(){t.addNewFile(i),c(t.iDocTimer)}]):(t.runEvent("onDrop",[i,e]),t.addNewFile(i),c(t.iDocTimer)))}),d(t.oOptions,"multipleSizeLimit",h),t.getEvent("onLimitReached"),!d(t.oOptions,"disableFolderDragAndDrop",!0))),t.runEvent("onDragLeave",[e])})))}(e):e.bEnableDnD=!1,m(e,"on",e.on),m(e,"cancel",e.cancel),m(e,"isDragAndDropSupported",e.isDragAndDropSupported),m(e,"isAjaxUploaderSupported",e.isAjaxUploaderSupported),m(e,"setDragAndDropEnabledStatus",e.setDragAndDropEnabledStatus)}T.prototype.oXhrs={},T.prototype.oUids={},T.prototype.oJua=null,T.prototype.oOptions={},T.prototype.isDragAndDropSupported=function(){return!0},T.prototype.regTaskUid=function(t){this.oUids[t]=!0},T.prototype.uploadTask=function(t,e,i,n,r,a,l){if(!1===this.oUids[t]||!e||!e.File)return n(null,t),!1;try{var h=this,c=new XMLHttpRequest,p=new FormData,m=d(this.oOptions,"action",""),f=s.clone(d(this.oOptions,"hidden",{})),b=this.oJua.getEvent("onStart"),y=this.oJua.getEvent("onComplete"),g=this.oJua.getEvent("onProgress");return c.open("POST",m,!0),c.setRequestHeader("Authorization","Bearer "+o.cookie("AuthToken")),g&&c.upload&&(c.upload.onprogress=function(i){i&&i.lengthComputable&&!u(i.loaded)&&!u(i.total)&&(void 0===l?g(t,i.loaded,i.total):g(t,l+i.loaded>e.Size?e.Size:l+i.loaded,e.Size))}),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){if(y&&!r){var e=!1,i=null;try{i=o.parseJSON(c.responseText),e=!0}catch(t){i=null}y(t,e,i)}u(h.oXhrs[t])||(h.oXhrs[t]=null),n(a?c.responseText:null,t)}else 4===c.readyState&&(y(t,!1,null),n(null,t))},b&&b(t),p.append("jua-post-type","ajax"),p.append(d(this.oOptions,"name","juaFile"),e.File,e.FileName),i=s.extend(i,e.Hidden||{}),f.Parameters=JSON.stringify(i),o.each(f,(function(t,i){p.append(t,F(i,[e]))})),c.send(p),this.oXhrs[t]=c,!0}catch(t){window.console&&window.console.error(t)}return n(null,t),!1},T.prototype.generateNewInput=function(t){var e=this,i=null,s=null;t&&(s=v("",!d(this.oOptions,"disableMultiple",!1),d(this.oOptions,"hiddenElementsPosition","left"),d(this.oOptions,"accept","")),(i=S()).append(s),o(t).append(i),s.on("click",(function(t){if(e.oJua.bEnableButton){var i=e.oJua.getEvent("onDialog");i&&i()}else t.preventDefault()})).on("change",(function(){g(this,(function(o){e.oJua.addNewFile(o),e.generateNewInput(t),setTimeout((function(){i.remove()}),10)}),d(e.oOptions,"multipleSizeLimit",h),e.oJua.getEvent("onLimitReached"))})))},T.prototype.cancel=function(t){if(this.oUids[t]=!1,this.oXhrs[t]){try{this.oXhrs[t].abort&&this.oXhrs[t].abort()}catch(t){}this.oXhrs[t]=null}},P.prototype.oUids={},P.prototype.oForms={},P.prototype.oJua=null,P.prototype.oOptions={},P.prototype.isDragAndDropSupported=function(){return!1},P.prototype.regTaskUid=function(t){this.oUids[t]=!0},P.prototype.uploadTask=function(t,e,i,n,r,a,l){if(!1===this.oUids[t])return n(null,t),!1;var h=this.oForms[t],u=s.clone(d(this.oOptions,"hidden",{})),c=this.oJua.getEvent("onStart"),p=this.oJua.getEvent("onComplete");return h?(h.append(o('<input type="hidden" />').attr("name","jua-post-type").val("iframe")),i=s.extend(i,e.Hidden||{}),u.Parameters=JSON.stringify(i),o.each(u,(function(t,i){h.append(o('<input type="hidden" />').attr("name",t).val(F(i,[e])))})),h.trigger("submit"),c&&c(t),h.find("iframe").on("load",(function(e){var i=!1,s=null,r={};if(p){try{s=this.contentDocument?this.contentDocument:this.contentWindow.document,r=o.parseJSON(s.body.innerHTML),i=!0}catch(t){r={}}p(t,i,r)}n(null,t),window.setTimeout((function(){h.remove()}),100)}))):n(null,t),!0},P.prototype.generateNewInput=function(t){var e=this,i="",s=null,n=null,r=d(this.oOptions,"action",""),a=null,l=d(this.oOptions,"hiddenElementsPosition","left");t&&(i=f(),s=v(d(this.oOptions,"name","juaFile"),!d(this.oOptions,"disableMultiple",!1),d(this.oOptions,"hiddenElementsPosition","left"),d(this.oOptions,"accept","")),a=o('<form action="'+r+'" target="iframe-'+i+'"  method="POST" enctype="multipart/form-data" style="display: block; cursor: pointer;"></form>'),n=o('<iframe name="iframe-'+i+'" tabindex="-1" src="javascript:void(0);"  style="position: absolute; top: -1000px; '+l+': -1000px; cursor: pointer;" />').css({opacity:0}),a.append(S().append(s)).append(n),o(t).append(a),this.oForms[i]=a,s.on("click",(function(t){if(e.oJua.bEnableButton){var i=e.oJua.getEvent("onDialog");i&&i()}else t.preventDefault()})).on("change",(function(){g(this,(function(o){if(o){var s=d(e.oOptions,"hiddenElementsPosition","left");a.css({position:"absolute",top:-1e3}),a.css(s,-1e3),e.oJua.addFile(i,o),e.generateNewInput(t)}}),d(e.oOptions,"multipleSizeLimit",h),e.oJua.getEvent("onLimitReached"))})))},P.prototype.cancel=function(t){this.oUids[t]=!1,this.oForms[t]&&(this.oForms[t].remove(),this.oForms[t]=!1)},C.prototype.bEnableDnD=!0,C.prototype.iDocTimer=0,C.prototype.oOptions={},C.prototype.oEvents={},C.prototype.oQueue=null,C.prototype.oDriver=null,C.prototype.on=function(t,e){return this.oEvents[t]=e,this},C.prototype.runEvent=function(t,e){this.oEvents[t]&&this.oEvents[t].apply(null,e||[])},C.prototype.getEvent=function(t){return this.oEvents[t]||null},C.prototype.cancel=function(t){this.oDriver.cancel(t)},C.prototype.isAjaxUploaderSupported=function(){return(t=document.createElement("input")).type="file",!!("XMLHttpRequest"in window&&"multiple"in t&&"FormData"in window&&(new XMLHttpRequest).upload);var t},C.prototype.setDragAndDropEnabledStatus=function(t){this.bEnableDnD=!!t},C.prototype.isDragAndDropSupported=function(){return this.oDriver.isDragAndDropSupported()},C.prototype.addNewFile=function(t){this.addFile(f(),t)},C.prototype.addFile=function(t,e){var i=this.getEvent("onSelect"),r=null,a=d(this.oOptions,"hidden",{}),h=this.getEvent("onComplete"),c=s.bind((function(t,e){var i,o,s=d(this.oOptions,"hidden",{}),n=JSON.parse(F(s.Parameters,[e]));this.oDriver.regTaskUid(t),this.oQueue.defer((i=this.oDriver.uploadTask,o=this.oDriver,function(){return i.apply(u(o)?null:o,Array.prototype.slice.call(arguments))}),t,e,n)}),this),p=this.getEvent("onCancel");if(!e||i&&!1===i(t,e))this.oDriver.cancel(t);else{r=s.bind((function(t,e,i,s,n,a){var u;u=function(e,s){var n=null;try{n=o.parseJSON(e)}catch(t){}n&&n.Result&&!n.Result.Error&&!n.ErrorCode?i(t,r):n&&n.Result&&n.Result.Error?(l.broadcastEvent("Jua::FileUploadingError"),h(s,!1,{ErrorCode:n.Result.Error})):n&&n.ErrorCode?(l.broadcastEvent("Jua::FileUploadingError"),h(s,!1,{ErrorCode:n.ErrorCode})):(l.broadcastEvent("Jua::FileUploadingError"),h(s,!1))};var c=d(this.oOptions,"hidden",{}),p=JSON.parse(F(c.Parameters,[e]));this.oDriver.regTaskUid(t),this.oDriver.uploadTask(t,e,p,u,s<n,!0,a)}),this);var m=n.observable(!0),f=JSON.parse(F(a.Parameters,[e]));l.broadcastEvent("Jua::FileUpload::isUploadAvailable",{isUploadAvailable:m,sModuleName:a.Module,sUid:t,oFileInfo:e}),m()?!1===l.broadcastEvent("Jua::FileUpload::before",{sUid:t,oFileInfo:e,fOnChunkReadyCallback:r,sModuleName:a.Module,fRegularUploadFileCallback:c,fCancelFunction:p,sStorageType:f.Type})&&c(t,e):s.isFunction(p)&&p(t)}},C.prototype.setOption=function(t,e){this.oOptions[t]=e},t.exports=C},p2SF:function(t,e,i){"use strict";var o=i("F/us"),s=i("AFLV"),n=i("Jq2H"),r="s.",a="p.",l={};function h(t){return a===t.substr(0,a.length)}l.getFiles=function(t,e,i){var o=[n.HashModuleName];return t&&""!==t&&o.push(t),e&&""!==e&&o.push(a+e),i&&""!==i&&o.push(r+i),o},l.parseFiles=function(t){var e,i=0,o="personal",n="",u="";return s.isNonEmptyArray(t)&&(t.length>i&&!h(t[i])&&(o=s.pString(t[i]),i++),t.length>i&&h(t[i])&&(n=s.pString(t[i].substr(a.length)),i++),t.length>i&&(e=t[i],r===e.substr(0,r.length))&&(u=s.pString(t[i].substr(r.length)))),l.getParsedParams(o,n,u)},l.getParsedParams=function(t,e,i){var n=[],r="";return s.isNonEmptyString(e)?r=(n=o.without(e.split(/(?:\/|\$ZIP\:)/g),""))[n.length-1]:e="",{Storage:t,Path:e,PathParts:n,Name:r,Search:i}},t.exports=l},qsz4:function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("0h2I"),r=i("czxF");function a(){r.call(this),this.fCallback=null,this.name=n.observable(""),this.focused=n.observable(!1),this.error=n.observable(""),this.name.subscribe((function(){this.error("")}),this)}o.extendOwn(a.prototype,r.prototype),a.prototype.PopupTemplate="FilesWebclient_RenamePopup",a.prototype.onOpen=function(t,e){this.fCallback=e,this.name(t),this.focused(!0),this.error("")},a.prototype.onOKClick=function(){if(this.error(""),s.isFunction(this.fCallback)){var t=this.fCallback(this.name());t?this.error(t):this.closePopup()}else this.closePopup()},t.exports=new a},szb4:function(t,e,i){"use strict";t.exports=function(t){i("kbJU");var e=i("IAk5"),o=i("OgeD"),s=i("RN+F"),n=i("Jq2H"),r=null,a=e.getUserRole()===Enums.UserRole.SuperAdmin,l=e.getUserRole()===Enums.UserRole.TenantAdmin,h=[],u=null,c=null;if(n.init(t),!o.isModuleAvailable(n.ServerModuleName)||!e.isPublic()&&0===n.Storages.length)return null;if(e.isPublic())return{getScreens:function(){var t={};return t[n.HashModuleName]=function(){return new(i("dtb0"))},t}};if(a||e.isUserNormalOrTenant()){if(a)return{start:function(t){t.run("AdminPanelWebclient","registerAdminPanelTab",[function(t){i.e(22).then(function(){t(i("DnLV"))}.bind(null,i)).catch(i.oe)},n.HashModuleName,s.i18n("FILESWEBCLIENT/LABEL_SETTINGS_TAB")])},hidePersonalFilesAdminSection:function(){n.ShowPersonalFilesAdminSection&&(c||(c=i("TX6J")),c.hide())}};if(e.isUserNormalOrTenant())return e.isNewTab()?{getSelectFilesPopup:function(){return i("vsjN")}}:{start:function(t){l&&t.run("AdminPanelWebclient","registerAdminPanelTab",[function(t){i.e(22).then(function(){t(i("DnLV"))}.bind(null,i)).catch(i.oe)},n.HashModuleName,s.i18n("FILESWEBCLIENT/LABEL_SETTINGS_TAB")]),(n.ShowCommonSettings||n.ShowFilesApps)&&t.run("SettingsWebclient","registerSettingsTab",[function(){return i("c3Cn")},n.HashModuleName,s.i18n("FILESWEBCLIENT/LABEL_SETTINGS_TAB")])},getScreens:function(){var t={};return t[n.HashModuleName]=function(){var t=i("dtb0");return(u=new t).registerToolbarButtons(h),h=[],u},t},getHeaderItem:function(){if(null===r){var t=i("Ig+v"),e=""!==n.CustomTabTitle?n.CustomTabTitle:s.i18n("FILESWEBCLIENT/ACTION_SHOW_FILES");r=new t(e)}return{item:r,name:n.HashModuleName}},getSelectFilesPopup:function(){return i("vsjN")},getMobileSyncSettingsView:function(){return i("AGjx")},registerToolbarButtons:function(t){u?u.registerToolbarButtons([t]):h.push(t)}}}return null}},vsjN:function(t,e,i){"use strict";var o=i("F/us"),s=i("EVdn"),n=i("czxF"),r=i("dtb0"),a=i("Pg7U");function l(){n.call(this),this.oFilesView=new r(!0),this.oFilesView.onSelectClickPopupBound=o.bind(this.onSelectClick,this),this.fCallback=null}o.extendOwn(l.prototype,n.prototype),l.prototype.PopupTemplate="FilesWebclient_SelectFilesPopup",l.prototype.onOpen=function(t){s.isFunction(t)&&(this.fCallback=t),this.oFilesView.onShow()},l.prototype.onBind=function(){this.oFilesView.onBind(this.$popupDom)},l.prototype.onSelectClick=function(){var t=this.oFilesView.selector.listCheckedAndSelected(),e=o.filter(t,(function(t){return t instanceof a}),this);this.fCallback&&this.fCallback(e),this.closePopup()},t.exports=new l},"w+bY":function(t,e,i){var o;!function(){function s(t){function e(){for(;a=u<h.length&&t>c;){var e=u++,o=h[e],s=r.call(o,1);s.push(i(e)),++c,o[0].apply(null,s)}}function i(t){return function(i,s){--c,null==d&&(null!=i?(d=i,u=p=NaN,o()):(h[t]=s,--p?a||e():o()))}}function o(){null!=d?m(d):l?m(d,h):m.apply(null,[d].concat(h))}var s,a,l,h=[],u=0,c=0,p=0,d=null,m=n;return t||(t=1/0),s={defer:function(){return d||(h.push(arguments),++p,e()),s},await:function(t){return m=t,l=!1,p||o(),s},awaitAll:function(t){return m=t,l=!0,p||o(),s}}}function n(){}var r=[].slice;s.version="1.0.7",void 0===(o=function(){return s}.call(e,i,e,t))||(t.exports=o)}()}}]);